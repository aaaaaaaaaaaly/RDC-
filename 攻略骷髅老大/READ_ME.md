# READ_ME

## 思路和代码功能说明

## 数据清洗

- 先导入需要的库，已经中文字符处理



- 读取要处理数据



- 进入处理
- - 先修改列名
  - 初步观察数据信息
  - 查看缺失数据
  - 处理缺失数据：删除393条，对整体数据量影响不大
  - 查看重复数据并处理：结果无重复数据
  - 查看异常值：使用箱线图---->删除离群值
  - - 先计算上下四分位然后计算上下限，再把超过上下限的数据删除
    - 对于离港延迟和到达延迟，由于这是不可控因素，本身时间取决于航班的跨度，没有办法获取平均，同时也发现，如果把离群值都删除，那么剩下的就不多了，所以不删除离港延迟和到达延迟中的离群值
  - 独热编码，把字符的特征编码化
  - 查看特征系数，删除相关系数不大的 **cal_coeffient函数**
  - 转化数据类型为int，因为本身也没有小数点，float会让之后的运算总是保留小数点，防止小数点太多造成溢出 **change_type函数**
  - 保存清洗结果





## 逻辑模型

**知识理解**：

假设函数改变，代价函数随之改变，且变成非凸函数。

代价函数优化为凸函数，求最小：
$$
j（theta）=(-1/m)\sum\limits_{i=1}^m[ylog(h(x))+(1-y)log(1-h(x))]
$$
代码实现：

代价函数表达式改变，按照以上公式返回代价函数值

更新theta时，也无法像线性回归中只需要计算代价函数就可以获得pred值，从而直接简化求`hx`
$$
theta：=theta-(alpha/m)\sum\limits_{i=1}^m[(hx-y)*x_j^{(i)}]
$$
这个更新theta的函数是一样的；

但是代价函数的`hx`发生改变
$$
hx=1/(1+e^{-theta^{T}*x})
$$

- 导入库和对中文字符进行处理

- 查看导入的数据，初步处理数据

- 插入x0，将数据划分前5000
- 进行标准化，更利于梯度下降



- 定义需要的函数

- - 首先是sigmoid函数（本质理解）：

    **学习链接**：[(51条消息) 逻辑回归(logistic regression)的本质——极大似然估计_zjuPeco的博客-CSDN博客_逻辑回归的本质](https://blog.csdn.net/zjuPeco/article/details/77165974)

    

  - 代价函数：

  - - 根据后验概率，求y=1的概率大小，就有概率一般式

    - $$
      L(w)=\prod_{i=1}^np（y=0|x:w)=y(z)^y(1-y(z))^{(1-y)}
      $$

      用极大似然求出w，其中需要取对数，从乘法边加法
      $$
      l(w)=ln(L)
      $$

    - 这样求的是 l 最大,前面加负号，就是最小的的时候，即最适合的w

    

  - 梯度下降函数

  - - 根据公式：

    $$
    j(w)=-l(w)=-\sum^n_{i=1}yln(y(z))+(1-y)ln(1-y(z))
    $$

    $$
    z=\frac{1}{1+e^{-θ^{T}X}}
    $$

    $$
    theta=theta-alpha\sum_{i=1}^m(pre-y).x
    $$

    - 其中：

    $$
    min(j(w))即对j求偏导，算出来的偏导即为：(predict-y).x_j
    $$

  

- 画图，梯度下降

- 模型评估

  - 精确率和召回率

  - ![](https://s1.ax1x.com/2022/04/05/qLFV9x.jpg)

    ![](https://s1.ax1x.com/2022/04/05/qLFZ36.jpg)

    

    根据定义自定义函数：

    **predict_TF函数**的功能是：传入阈值和预测值，划分1,0进行分类

    **cal_TFPN函数**的功能是：根据划分来判断样本是正还是负，

    **ROC函数**的功能是：根据TP，TN，FP，FN来进行计算，便于后续画图
    
    
