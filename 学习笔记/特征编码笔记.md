# 特征编码

- 学习链接：[机器学习“特征编码”解析_IT独白者的博客-CSDN博客_特征编码](https://blog.csdn.net/sun_wangdong/article/details/82377284)

## **前情引入**

- 对于文本数据，计算机没办法处理，也有一些算法能够处理文本数据，不需要进行特征编码的操作

- 对于数据类型的划分，我们一般会划分为 **结构化数据** 和 **非结构化数据**，文本和图像都属于非结构化数据，对于数字数据，分为离散化数据和连续性数据



**特征编码**

- **类别型特征**:主要指性别，血型等在有限选项中取值的特征

  （对于逻辑回归，svm等模型来说，类别型必须经过处理转化成数值型才能正常进行工作）

- 对于类别型数据，我们可以分为 **有序**和 **无序**的数据。

​       比如男女显然是无序的，但是中高低是有序的，对于这两类数据，处理方式不一样



**对于分类型特征的编码，我们通常会使用2种方式实现：独热编码，标签编码**





------

## 独热编码（哑变量）

- **使用场景：**处理类别见**不具有**大小关系的特征（比如血型)



- 一共有4个取值（A型血、B型血、AB型血、O型血），独热编码会把血型变成一个4维稀疏向量，A型血表示为（1, 0, 0, 0），B型血表示为（0, 1, 0, 0），AB型表示为（0, 0, 1, 0），O型血表示为（0, 0, 0, 1）



- 涉及到 **稀疏向量**.独热编码使用了稀疏向量来节省空间，（稀疏向量可以简单理解成系数矩阵）。这显然提高了特征的维度，本来是一列数据，现在变成4列。但是我们可以通过 **特征选择**来降低维度



- **举例说明**

图中的Elevator和Renovation都是**定类型数据**。除去缺失值，Elevator分类有电梯和无电梯两种。Renovation分为有精装，简装，毛坯和其它四种。

![](https://s1.ax1x.com/2022/03/19/qAxP3t.png)

- 代码举例

```python
pd.get_dummies(lianjia_df['elevator'])
```



- **函数功能解析：**

```python
pandas.get_dummies(data,
                   prefix=None,
                   prefix_sep='_', 
                   dummy_na=False, 
                   columns=None, 
                   sparse=False,
                   drop_first=False)[source]

#也可以对专门的列进行分类
pandas.get_dummies(data.column)

#将分出来的列重新合并
#比如
df = df.join(pd.get_dummies(df.color))
```

（发现维度会上升）

- **独热编码就是将原始特征变量转换成以原始特征值分类的多维度的变量，并用是否（0,1）这种方式的新特征值替代和量化。**





------

## 标签编码

- class特征是 **定序数据类型**,**也是分类类型，但是比定类更高级，因为有排序**



- 举例：

```python
classmap={'大一':1,'大二':2,'大三':3,'大四':4}
df['Class']=df['Class'].map(classmap)\

df
```

![](https://s1.ax1x.com/2022/03/19/qEpOGd.png)





## 总结

- one_hot encoding

**优点：**解决了分类器不好处理分类数据的问题，在一定程度上也起到了扩充特征的作用。**它的值只有0和1**，不同的类型存储在垂直的空间。

**缺点:**当类别的数量很多时，特征空间会变得非常大，容易造成**维度灾难**。





- label-encoding

**优点：**解决了分类编码的问题，可以自由定义量化数字。但其实也是缺点，因为数值本身没有任何含义，只是排序。如大中小编码为123，也可以编码为321，即数值没有意义。

**缺点：**可解释性比较差。比如有[dog,cat,dog,mouse,cat]，我们把其转换为[1,2,1,3,2]，这里就产生了一个奇怪的现象：dog和mouse的平均值是cat。因此，Label encoding编码**其实并没有很宽的应用场景。**



- 还有许多其他特征编码比如 **二进制编码**，**离散化编码**（比如90-100是A等级）等等